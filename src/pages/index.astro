---
import { getCollection } from 'astro:content';
import Layout from '../layouts/general.astro';
import Blog from '../components/card-blog.astro';
import Project from '../components/card-project.astro';
import H2 from '../components/common/h2.astro';
import H1 from '../components/common/h1.astro';
import P from '../components/common/p.astro';
import A from '../components/common/a.astro';
import Social from '../components/social.astro';

const blogs = await getCollection('blog');
const projects = [
  {
    title: 'Prot√©rmico',
    link: 'https://www.behance.net/gallery/66596359/Protermico-Project',
  },
];

function readingTime(post: string) {
  const WORDS_PER_MINUTE = 200;
  const regex = /\w+/g;
  const wordCount = post.match(regex)?.length || 0;

  return Math.ceil(wordCount / WORDS_PER_MINUTE);
}
---

<Layout title="Juansereina">
  <main class="mb-8 sm:mb-10">
    <!-- Introduction -->
    <div class="text-white mb-8 sm:mb-10">
      <H1 classes="text-center md:text-start mb-4 md:mb-6 lg:mb-8">
        Hola, soy
        <span
          class="text-transparent bg-clip-text bg-gradient-to-r from-sky-400 to-cyan-300"
          >Juansereina</span
        >
        üëã
      </H1>
      <P classes="max-w-md mb-4 md:mb-6 lg:mb-8">
        Soy <strong>Web Developer</strong>, aqu√≠ comparto algunas ideas sobre
        cosas creativas con c√≥digo, libros y temas de mi interes ü§™ üçî
      </P>
      <Social />
    </div>
    <!-- End -->
    <!-- Post -->
    <div class="flex items-baseline">
      <H2
        text="√öltimos"
        strongText="Posts"
        classes="flex flex-1 mb-4 md:mb-6 lg:mb-8"
      />
      <A href="/blog/es">
        <span class="text-white">
          Ver todos
          <i class="fa-solid fa-circle-arrow-right text-sm"></i>
        </span>
      </A>
    </div>
    <ul class="flex max-sm:flex-wrap mb-8 sm:mb-10 gap-4">
      {
        blogs.map(({ data, slug, body }) => {
          return (
            <Blog
              title={data.title}
              alt={data.image.alt}
              src={data.image.src}
              href={`/blog/${slug}`}
              publishedAt={data.publishedAt}
              readingTime={readingTime(body)}
            />
          );
        })
      }
    </ul>
    <!-- End -->
    <!-- Projects -->
    <div class="2">
      <H2 text="M√°s recientes" strongText="Proyectos" classes="flex flex-1" />
    </div>
    <ul class="mt-4 flex flex-col gap-1">
      {projects.map(({ title, link }) => <Project title={title} href={link} />)}
    </ul>
    <!-- End -->
  </main>
</Layout>
