---
import { getCollection } from 'astro:content';
import Layout from '../layouts/general.astro';
import Blog from '../components/card-blog.astro';
import H2 from '../components/common/h2.astro';
import A from '../components/common/a.astro';
import Social from '../components/social.astro';
import { readingTime } from '../utils';
import projects from '../data/projects.json';

const blogs = await getCollection('blog', (item) => !item.data.draft);
---

<Layout>
  <main class="mb-8 sm:mb-10">
    <!-- Introduction -->
    <header class="text-white mb-10 sm:mb-12">
      <div
        class="flex flex-wrap gap-1 text-2xl sm:text-4xl lg:sm:text-5xl justify-center md:justify-start mb-4 md:mb-6 lg:mb-8"
      >
        <span>Hola, soy</span>
        <strong>
          <h1>Juan Sebastián</h1>
        </strong>
        👋
      </div>
      <div class="flex max-md:flex-col gap-8">
        <img
          class="max-w-md w-full md:w-2/6 mx-auto rounded border border-gray-500"
          src="/images/profile.webp"
          alt=""
        />
        <div class="flex-1 gap-4 flex flex-col">
          <p>
            Soy <strong>Web Developer</strong>, llevo unos años trabajando
            <strong>JavaScript</strong>. He tenido la oportunidad de aprender de
            muchas personas 👨‍💻, por lo que decidí compartir algunas ideas sobre
            cosas creativas con
            <strong>código</strong> 👨‍🎨, <strong>libros</strong> 📚 y temas que he
            aprendido con el tiempo 🤔
          </p>
          <Social classes="mt-auto" />
        </div>
      </div>
    </header>
    <!-- End -->
    <!-- Projects -->
    <div class="mb-4">
      <H2 text="Más recientes" strongText="Proyectos" classes="flex flex-1" />
    </div>
    <ul class="flex flex-col mb-10 sm:mb-12 gap-4">
      {
        projects.map(({ title, link, icons }) => (
          <li class="w-full p-2 rounded border border-gray-600  bg-gray-700 hover:border-white">
            <a href={link} class="w-full text-white flex items-center gap-2">
              <p class="flex-1">{title}</p>
              {icons.map((ico) => (
                <i class={`${ico} text-lg`} />
              ))}
            </a>
          </li>
        ))
      }
    </ul>
    <!-- End -->
    <!-- Post -->
    <div class="flex items-baseline">
      <H2
        text="Últimos"
        strongText="Posts"
        classes="flex flex-1 mb-4 md:mb-6 lg:mb-8"
      />
      <A href="/blog/es">
        <span class="text-white">
          Ver todos
          <i class="fa-solid fa-circle-arrow-right text-sm"></i>
        </span>
      </A>
    </div>
    <ul class="grid sm:grid-cols-3 gap-4">
      {
        blogs
          .filter((_, index) => index < 3)
          .map(({ data, slug, body }) => {
            return (
              <Blog
                title={data.title}
                alt={data.image.alt}
                src={data.image.src}
                href={`/blog/${slug}`}
                publishedAt={data.publishedAt}
                readingTime={readingTime(body)}
              />
            );
          })
      }
    </ul>
    <!-- End -->
  </main>
</Layout>
